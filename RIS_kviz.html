<script>

const questions = [ 
/* TUKAJ OSTANE TVOJ CEL SEZNAM VPRAŠANJ */
];

let current = 0;
let answers = new Array(questions.length).fill(null);

function render(){
const q = questions[current];
const div = document.getElementById("quiz");

div.innerHTML = `
<h2>Vprašanje ${current+1} / ${questions.length}</h2>
<p>${q.question}</p>
`;

if(q.type==="boolean"){
div.innerHTML += `
<div class="option">
<input type="radio" name="ans" value="true"> DA
</div>
<div class="option">
<input type="radio" name="ans" value="false"> NE
</div>`;
}
else{
q.options.forEach((opt,i)=>{
div.innerHTML += `
<div class="option">
<input type="checkbox" value="${i}"> ${opt}
</div>`;
});
}

div.innerHTML += `
<button onclick="prev()">Nazaj</button>
<button class="primary" onclick="next()">Naprej</button>
`;

restoreAnswer();
}

function restoreAnswer(){
const saved = answers[current];
if(saved === null) return;

const q = questions[current];

if(q.type==="boolean"){
document.querySelector(`input[value="${saved}"]`)?.click();
}
else{
saved.forEach(i=>{
document.querySelector(`input[value="${i}"]`)?.click();
});
}
}

function saveAnswer(){
const q = questions[current];

if(q.type==="boolean"){
const s = document.querySelector('input[name="ans"]:checked');
answers[current] = s ? s.value : null;
}
else{
const checked = [...document.querySelectorAll('input[type="checkbox"]:checked')]
.map(c=>parseInt(c.value));
answers[current] = checked;
}
}

function next(){
saveAnswer();
if(current < questions.length - 1){
current++;
render();
}
else{
showResult();
}
}

function prev(){
saveAnswer();
if(current > 0){
current--;
render();
}
}

function showResult(){
saveAnswer();

let score = 0;
const div = document.getElementById("quiz");

div.innerHTML = `
<h2>Konec kviza</h2>
<button onclick="restartQuiz()" class="restart">Ponovno reševanje</button>
<div class="result"><h3>Pregled odgovorov:</h3>
`;

questions.forEach((q,i)=>{

let correct = false;
let userAnswer = answers[i];

if(q.type==="boolean"){
if(userAnswer !== null && (userAnswer==="true") === q.answer){
correct = true;
}
}
else{
const user = (userAnswer || []).slice().sort();
const correctAns = q.answer.slice().sort();
if(JSON.stringify(user) === JSON.stringify(correctAns)){
correct = true;
}
}

if(correct) score++;

div.innerHTML += `<p><b>${q.question}</b><br>`;

if(q.type==="boolean"){
const correctText = q.answer ? "DA" : "NE";
const userText = userAnswer===null ? "Ni odgovora" :
(userAnswer==="true" ? "DA":"NE");

div.innerHTML += `
Tvoj odgovor: <span class="${correct?'correct':'wrong'}">${userText}</span><br>
Pravilni odgovor: <span class="correct">${correctText}</span>
`;
}
else{
const correctTexts = q.answer.map(i=>q.options[i]);
const userTexts = (userAnswer||[]).map(i=>q.options[i]);

div.innerHTML += `
Tvoj odgovor: <span class="${correct?'correct':'wrong'}">
${userTexts.length ? userTexts.join(", ") : "Ni odgovora"}
</span><br>
Pravilni odgovori: <span class="correct">
${correctTexts.join(", ")}
</span>
`;
}

div.innerHTML += `<hr>`;
});

div.innerHTML = `
<h2>Rezultat: ${score} / ${questions.length}</h2>
<button onclick="restartQuiz()" class="restart">Ponovno reševanje</button>
<div class="result">
<h3>Pregled odgovorov:</h3>
${div.innerHTML}
</div>
`;
}

function restartQuiz(){
current = 0;
answers = new Array(questions.length).fill(null);
render();
}

render();

</script>
